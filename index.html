<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>預約跳轉中 v1.0.3</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body style="text-align:center; padding-top:50px; font-family:sans-serif;">
    <div style="font-size:10px; color:#ccc;">版本號：v1.0.3</div>
    <div id="msg">正在連接 LINE，請稍候...</div>

    <script>
        window.onload = function() {
            // 教練校對：2009065757-yV5zslQP (最後是小寫 l，不是大寫 I)
            const finalLiffId = "2009065757-yV5zslQP".trim(); 
            
            liff.init({ liffId: finalLiffId }) 
                .then(() => {
                    if (!liff.isLoggedIn()) {
                        liff.login();
                    } else {
                        liff.getProfile().then(profile => {
                            // 成功抓到 UID，跳轉至 Tally 並帶入參數
                            const tallyUrl = "https://tally.so/r/2EaWjb?line_uid=" + profile.userId;
                            window.location.replace(tallyUrl);
                        });
                    }
                })
                .catch((err) => {
                    document.getElementById("msg").innerHTML = 
                        "<b style='color:red;'>連線失敗</b><br>錯誤原因：" + err + 
                        "<br>目前使用的 ID: [" + finalLiffId + "]";
                });
        };
    </script>
</body>
</html>
