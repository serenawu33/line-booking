<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>預約跳轉中</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body style="text-align:center; padding-top:50px; font-family:sans-serif;">
    <div id="msg">連線校準中，請稍候...</div>
    <script>
        window.onload = function() {
            // .trim() 會自動切除前後多餘的空格
            const finalLiffId = "2009065757-yV5zsIQP".trim(); 
            
            liff.init({ liffId: finalLiffId }) 
                .then(() => {
                    if (!liff.isLoggedIn()) {
                        liff.login();
                    } else {
                        liff.getProfile().then(profile => {
                            // 跳轉至 Tally 並帶入 UID
                            const tallyUrl = "https://tally.so/r/2EaWjb?line_uid=" + profile.userId;
                            window.location.replace(tallyUrl);
                        });
                    }
                })
                .catch((err) => {
                    document.getElementById("msg").innerHTML = "偵測到錯誤：" + err;
                });
        };
    </script>
</body>
</html>
